using DrWatson
quickactivate(pwd(), "JuliaPulseExperiments")

using LinearAlgebra, QuantumToolbox

includet(srcdir("wasserstein_distance.jl"))


function random_density_matrix(Nqubits::Integer)
    Nhilbert = 2^Nqubits
    A = rand(ComplexF64, Nhilbert, Nhilbert)
    AAdagger = A*A'
    rho = (AAdagger) / tr(AAdagger)
    return rho
end

function pretty_print(A::AbstractMatrix, delim=" ")
    for row in eachrow(A)
        for el in row 
            print(el, delim)
        end
        println(";")
    end
end


rho1 = [
0.1702172709767004+0.0im 0.10071729084107524+0.002402303549248124im 0.13104706233195781+0.01932138727448644im 0.0938691951621668+0.010795658805930336im 0.09968606422315286+0.05073987479469209im 0.1458854168206654+0.008769317124528348im 0.11140141612792391+0.012111964137226414im 0.12656844903771633+0.00016888930161303533im;
0.10071729084107524-0.002402303549248124im 0.10457991252642056+0.0im 0.09976504934171534+0.03032907964087952im 0.05682925481934106+3.741912550850694e-5im 0.05003991605537301+0.02485148468616947im 0.09934148456249739-8.045761509213987e-5im 0.06973784667359215+0.010037381658962103im 0.08246090269356081+0.0034216539097357388im;
0.13104706233195781-0.01932138727448644im 0.09976504934171534-0.03032907964087952im 0.1370256617562471+0.0im 0.08220657836220133-0.011528735936549328im 0.08070679965922482+0.02430715668931102im 0.128603566707289-0.014542042602856551im 0.08718191260444853+0.004266579690082119im 0.10629205097809882-0.019816813793823433im;
0.0938691951621668-0.010795658805930336im 0.05682925481934106-3.741912550850694e-5im 0.08220657836220133+0.011528735936549328im 0.08086555588122879+0.0im 0.07181530654425532+0.02625109184500752im 0.09388520339585488+0.011425617903608274im 0.05566374317200233-0.0029670358306180247im 0.08785728055412356-0.004785349351024265im;
0.09968606422315286-0.05073987479469209im 0.05003991605537301-0.02485148468616947im 0.08070679965922482-0.02430715668931102im 0.07181530654425532-0.02625109184500752im 0.10702447426690832+0.0im 0.10051218568863299-0.0227802458789327im 0.05785011201134336-0.02698375030328766im 0.08568927159902223-0.059925970358682024im;
0.1458854168206654-0.008769317124528348im 0.09934148456249739+8.045761509213987e-5im 0.128603566707289+0.014542042602856551im 0.09388520339585488-0.011425617903608274im 0.10051218568863299+0.0227802458789327im 0.16119347855568938+0.0im 0.09707207677521956+0.01697244891463438im 0.11258153595662773-0.02458152763713495im;
0.11140141612792391-0.012111964137226414im 0.06973784667359215-0.010037381658962103im 0.08718191260444853-0.004266579690082119im 0.05566374317200233+0.0029670358306180247im 0.05785011201134336+0.02698375030328766im 0.09707207677521956-0.01697244891463438im 0.10714989441989832+0.0im 0.07373400510584567+0.0017989603868138469im;
0.12656844903771633-0.00016888930161303533im 0.08246090269356081-0.0034216539097357388im 0.10629205097809882+0.019816813793823433im 0.08785728055412356+0.004785349351024265im 0.08568927159902223+0.059925970358682024im 0.11258153595662773+0.02458152763713495im 0.07373400510584567-0.0017989603868138469im 0.1319437516169071+0.0im;
]

rho2 = [
0.09437670768302003+0.0im 0.06908030649533184-0.025856640474361696im 0.0571698051942674+0.001723558449643474im 0.052373511666094455-0.02193259412968564im 0.08690604302766017-0.037551045910767085im 0.07724731516319489+0.013154373764010093im 0.0755192862954009-0.0060187887707030575im 0.06767946231482402-0.002455174413735868im;
0.06908030649533184+0.025856640474361696im 0.13750372150817539+0.0im 0.09659277415468057+0.03088626390071415im 0.09839757790658815-0.01843604837910868im 0.11959631460416928+0.01591165044484575im 0.09127776713320487+0.0029664032316979545im 0.10812253076186823+0.016203950275760264im 0.10126658128533678+0.03296240908425086im;
0.0571698051942674-0.001723558449643474im 0.09659277415468057-0.03088626390071415im 0.10749339317753213+0.0im 0.07364350077227144-0.031392049105149616im 0.11358197622944208-0.01963770203421925im 0.08385576524658818-0.020816876652428207im 0.07741863830576362-0.01775870544936966im 0.09961324918078568-0.0019955769966365604im;
0.052373511666094455+0.02193259412968564im 0.09839757790658815+0.01843604837910868im 0.07364350077227144+0.031392049105149616im 0.1060067458169759+0.0im 0.0991335809946916+0.03601955547835592im 0.08355714103733318+0.01257203715404106im 0.08479891764122016+0.007852400196833625im 0.08192489755075795+0.029437069943435562im;
0.08690604302766017+0.037551045910767085im 0.11959631460416928-0.01591165044484575im 0.11358197622944208+0.01963770203421925im 0.0991335809946916-0.03601955547835592im 0.181118252737874+0.0im 0.09678691536040827+0.0257956409992361im 0.08265447466000513-0.0012124556387378734im 0.11944969362408149+0.013493055742961302im;
0.07724731516319489-0.013154373764010093im 0.09127776713320487-0.0029664032316979545im 0.08385576524658818+0.020816876652428207im 0.08355714103733318-0.01257203715404106im 0.09678691536040827-0.0257956409992361im 0.12995666212855037+0.0im 0.09026407094425183-0.00036960573749008057im 0.0962066591567112+0.0181161838206353im;
0.0755192862954009+0.0060187887707030575im 0.10812253076186823-0.016203950275760264im 0.07741863830576362+0.01775870544936966im 0.08479891764122016-0.007852400196833625im 0.08265447466000513+0.0012124556387378734im 0.09026407094425183+0.00036960573749008057im 0.1131493051294838+0.0im 0.087678245906856+0.02455825644333481im;
0.06767946231482402+0.002455174413735868im 0.10126658128533678-0.03296240908425086im 0.09961324918078568+0.0019955769966365604im 0.08192489755075795-0.029437069943435562im 0.11944969362408149-0.013493055742961302im 0.0962066591567112-0.0181161838206353im 0.087678245906856-0.02455825644333481im 0.13039521181838834+0.0im;
]

rho1Qobj = Qobj(rho1, dims=(2,2,2))
rho2Qobj = Qobj(rho2, dims=(2,2,2))

@show dist_primal = W1_primal(rho1Qobj, rho2Qobj)
@show dist_dual = W1_dual(rho1Qobj, rho2Qobj)

